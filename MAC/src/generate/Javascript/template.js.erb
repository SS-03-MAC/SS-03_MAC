var <%= name.capitalize %> = function(<%= fields_str %>){
<% fields.each do |field| %>
  <%= "this." + field["name"] + " = " + field["name"] + ";" %>
<% end %>
  this.id = 0
  this.createdAt = Date.getTime();
  this.updatedAt = Date.getTime();

};

<%= name.capitalize %>.get = function(id){
  xhr = new XMLHTTPRequest();
  xhr.onreadystatechenge = function() {
    if(xhr.readystate == 4){
      if(xhr.status == 200){
        var result = eval("("+xhr.responseTest+")");
        return result;
      } else{
        throw new Error(xhr.statusText);
      }
    }
  }

  xhr.open("GET", <%= "\"/" + name.pluralize + "/" %>id<%= "\"" %>, true);
  xhr.send(null);
}

<%= name.capitalize %>.getAll = function(){
  xhr = new XMLHTTPRequest();
  xhr.onreadystatechenge = function() {
    if(xhr.readystate == 4){
      if(xhr.status == 200){
        var result = eval("("+xhr.responseTest+")");
        return result;
      } else{
        throw new Error(xhr.statusText);
      }
    }
  }

  xhr.open("GET", <%="\"/" + name.pluralize + "\""%>, true);
  xhr.send(null);
}
